function Y = DRN_matlab(X)

% Layer 1
b1 = [0.48264735560922206181;1.3639134391284062353];
IW1_1 = [0.012441919637399871668 0.017557586694124729942 -0.023658342726462843614 -0.0099465642513465093305 0.013564602007647818399;3.2337963497828163817 0.84720143142460790919 -1.2706572586300173278 -2.2790466775665518817 -12.130440510320882552];
IW1_2 = [0.63922193345301658862 -0.25257574688745781932 -1.2439756751925667988 -1.2702005863004310893 -0.50444111151857307096;0.071790668469059640278 0.025986935075998692651 -0.10478596638688345011 0.012921870577848998049 0.069996226264180214094];

% Layer 2
b2 = [13.80071193511004779;10.877970953299280765;-11.647990933986248407;-1.8756573893208481341];
IW2_1 = [0.36617332044588041251 0.48436619078336312638 -0.68464007949024463517 -0.37106830500174381449 0.70773411597992519351;2.1434520257428673062 1.1773947796609502969 0.91245410755431199945 3.5725789380648502735 -5.126676714595558515;-0.31929926782966822074 -0.41788544130443661118 0.59547743583507262155 0.33217321760371010253 -0.65518809775351183333;1.4693647902653941273 1.4327286884697534308 0.77039400388329992708 -1.1027206059324801135 -4.9424666557313798876];
IW2_2 = [20.969753356014116719 -4.2235216672900044443 -33.879295937730809385 -41.805071895213480104 -30.211212993292949847;0.075707651364104483482 0.054330012009310799104 -0.13637489805220587291 -0.1146287110365446088 0.028974148485772687617;-18.242936462021244637 3.2413740200357854526 28.664525922900143229 35.96049949971648374 27.188723428201807764;0.085611956660068683211 0.034023784974668479231 -0.145505420699119703 -0.26731441854504134348 -0.22691867153952355318];
LW2_1 = [-28.606040660119745667 0.032309514379086877456;-0.051473119676535991629 -10.685622588886534601;24.387834318747756868 -0.032792120651157934119;-0.15288020724312451071 0.34204841576116895574];

% Layer 3
b3 = [4.9907516665261466571;-9.0003632353044125125];
IW3_1 = [5.2704453867718523696 4.6413193259308238581 2.2411490350433993513 -3.3692985515089399762 -16.070033123520250484;-18.075723829033016443 -15.781214992624640558 -8.1399291288523709653 11.144574062460700148 56.805754033791750146];
IW3_2 = [-1.2270696695740423987 -0.011303314868043583263 0.32085051395864350177 -0.4322578948824289391 0.11114017562381910131;0.50737492207337575589 -0.24644578884731521695 -0.16158490187499185975 0.49856982552890705129 0.20425366673601560996];
LW3_2 = [26.084742246065435012 -7.2499683658729887625 29.505801637908771085 -2.8817529876734342409;-12.054785184189931613 25.177166303297660477 -13.610038206446631648 9.9655795503484405629];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.00816959978587419;0.021070086515184];
y1_step1.xoffset = [5.12106156360812;5.05570270297132];

% Dimensions
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*X{1,1} + IW1_2*X{2,1});

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + IW2_1*X{1,1} + IW2_2*X{2,1} + LW2_1*a1);

% Layer 3
a3 = repmat(b3,1,Q) + IW3_1*X{1,1} + IW3_2*X{2,1} + LW3_2*a2;

% Output 1
Y = mapminmax_reverse(a3,y1_step1);

end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
